<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Quickswap Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Quickswap Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-128182339-7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Quickswap" href="/opensearch.xml"><title data-react-helmet="true">Building an Oracle | Quickswap</title><meta data-react-helmet="true" property="og:url" content="https://quickswap.github.io//guides/smart-contract-integration/04-building-an-oracle"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="V2"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-V2"><meta data-react-helmet="true" property="og:title" content="Building an Oracle | Quickswap"><meta data-react-helmet="true" name="description" content="To build a price oracle on Uniswap V2, you must first understand the"><meta data-react-helmet="true" property="og:description" content="To build a price oracle on Uniswap V2, you must first understand the"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo_circle.png"><link data-react-helmet="true" rel="canonical" href="https://quickswap.github.io//guides/smart-contract-integration/04-building-an-oracle"><link data-react-helmet="true" rel="alternate" href="https://quickswap.github.io//guides/smart-contract-integration/04-building-an-oracle" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://quickswap.github.io//guides/smart-contract-integration/04-building-an-oracle" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://S0IDD0YGLZ-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.45e62268.css">
<link rel="preload" href="/assets/js/runtime~main.a011c026.js" as="script">
<link rel="preload" href="/assets/js/main.e22ba48b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/quickswaplogo.png" alt="Quickswap Dragon" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/quickswaplogo.png" alt="Quickswap Dragon" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Quickswap Documentation</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/QuickSwap/quickswap-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">V2</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/quickswaplogo.png" alt="Quickswap Dragon" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/quickswaplogo.png" alt="Quickswap Dragon" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Quickswap Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/QuickSwap/quickswap-docs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link">Versions</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Protocol Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">How Quickswap works</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/protocol-overview/02-ecosystem-participants">Ecosystem Participants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/protocol-overview/03-smart-contracts">Smart contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/protocol-overview/04-glossary">Glossary</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Core Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/core-concepts/01-swaps">Swaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/core-concepts/02-pools">Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/core-concepts/03-flash-swaps">Flash Swaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/core-concepts/04-oracles">Introduction</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Advanced Topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/01-fees">Fees</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/02-pricing">How are prices determined?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/03-understanding-returns">Understanding Returns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/04-security">Audit &amp; Formal Verification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/05-math">Math</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/advanced-topics/06-research">Research</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Governance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/01-overview">Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/02-process">Process</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/03-guide-to-voting">Beginners Guide to Voting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/04-glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/05-adversarial-circumstances">Adversarial Circumstances</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/governance/06-governance-reference">Governance Reference</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Interface Integration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/interface-integration/01-using-the-api">Using the API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/interface-integration/02-custom-interface-linking">Query Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/interface-integration/03-iframe-integration">Iframe Integration</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Javascript SDK</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/javascript-sdk/01-quick-start">SDK Quick start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/javascript-sdk/02-fetching-data">Fetching Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/javascript-sdk/03-pricing">Pricing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/javascript-sdk/04-trading">Trading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/javascript-sdk/05-getting-pair-addresses">getPair</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Smart Contract Integration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/01-quick-start">Smart Contract Quick start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/02-trading-from-a-smart-contract">Implement a Swap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/03-providing-liquidity">Providing Liquidity</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/guides/smart-contract-integration/04-building-an-oracle">Building an Oracle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/05-using-flash-swaps">Flash Swaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/06-getting-pair-addresses">getPair</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/07-supporting-meta-transactions">Supporting meta transactions</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Technical Reference</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/">API Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/API/02-entities">Entities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/API/03-queries">Queries</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Governance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/Governance/05-governance-reference">Governance Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SDK</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/01-getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/02-token">Token</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/03-pair">Pair</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/04-route">Route</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/05-trade">Trade</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/06-fractions">Fraction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/07-fetcher">Fetcher</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/SDK/08-other-exports">JSBI</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Smart Contracts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/01-factory">Factory</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/pair">Pair</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/pair-erc-20">Pair (ERC-20)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/library">Library</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/router01">Router01</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/router02">Router02</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/reference/smart-contracts/common-errors">Common Errors</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Building an Oracle</h1></header><div class="markdown"><p>To build a price oracle on Uniswap V2, you must first understand the
requirements for your use case. Once you understand the kind of price
average you require, it is a matter of storing the cumulative price
variable from the pair as often as necessary, and computing
the average price using two or more observations of the
cumulative price variables.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="understanding-requirements"></a>Understanding requirements<a class="hash-link" href="#understanding-requirements" title="Direct link to heading">#</a></h1><p>To understand your requirements, you should first research the answer to the
following questions:</p><ul><li>Is data freshness important?
I.e.: must the price average include the current price?</li><li>Are recent prices more important than historical prices?
I.e.: is the current price given more weight than historical prices?</li></ul><p>Note your answers for the following discussion.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="oracle-strategies"></a>Oracle Strategies<a class="hash-link" href="#oracle-strategies" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fixed-windows"></a>Fixed windows<a class="hash-link" href="#fixed-windows" title="Direct link to heading">#</a></h2><p>In the case where data freshness is not important and recent prices
are weighted equally with historical prices, it is enough to
store the cumulative price once per period (e.g. once per 24 hours.)</p><p>Computing the average price over these data points gives you &#x27;fixed windows&#x27;,
which can be updated after the lapse of each period. We wrote
an example oracle of this kind
<a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleOracleSimple.sol" target="_blank" rel="noopener noreferrer">here</a>.</p><div href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleOracleSimple.sol">ExampleOracleSimple.sol</div><p>This example does not limit the maximum size of the fixed window, i.e.
it only requires that the window size is greater than 1 period (e.g. 24 hours).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="moving-averages"></a>Moving averages<a class="hash-link" href="#moving-averages" title="Direct link to heading">#</a></h2><p>In the case where data freshness is important, you can use a sliding
window in which the cumulative price variable is measured more often
than once per period.</p><p>There are at least
<a href="https://www.investopedia.com/terms/m/movingaverage.asp#types-of-moving-averages" target="_blank" rel="noopener noreferrer">two kinds of moving averages</a>
that you can compute using the Uniswap cumulative price variable.</p><p><a href="https://www.investopedia.com/terms/s/sma.asp" target="_blank" rel="noopener noreferrer">Simple moving averages</a>
give equal weight to each price measurement. We have built
an example of a sliding window oracle
<a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleSlidingWindowOracle.sol" target="_blank" rel="noopener noreferrer">here</a>.</p><p><a href="https://www.investopedia.com/terms/e/ema.asp" target="_blank" rel="noopener noreferrer">Exponential moving averages</a>
give more weight to the most recent price measurements. We do not yet have an example written for this type of oracle.</p><p>You may wish to use exponential moving averages where recent prices
are more important than historical prices, e.g. in case of liquidations. However, note that
putting more weight on recent prices makes the oracle cheaper to manipulate
than weighting all price measurements equally.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="computing-average-prices"></a>Computing average prices<a class="hash-link" href="#computing-average-prices" title="Direct link to heading">#</a></h2><p>To compute the average price given two cumulative price observations, take the difference between
the cumulative price at the beginning and end of the period, and
divide by the elapsed time between them in seconds. This will produce a
<a href="https://en.wikipedia.org/wiki/Fixed-point_arithmetic#Notation" target="_blank" rel="noopener noreferrer">fixed point unsigned Q112x112</a>
number that represents the price of one asset relative to the other. This number is represented as a <code>uint224</code> where
the upper 112 bits represent the integer amount, and the lower 112 bits represent the fractional amount.</p><p>Pairs contain both <code>price0CumulativeLast</code> and <code>price1CumulativeLast</code>, which are ratios of reserves
of <code>token1</code>/<code>token0</code> and <code>token0</code>/<code>token1</code> respectively. I.e. the price of <code>token0</code> is expressed in terms of
<code>token1</code>/<code>token0</code>, while the price of <code>token1</code> is expressed in terms of <code>token0</code>/<code>token1</code>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-the-latest-cumulative-price"></a>Getting the latest cumulative price<a class="hash-link" href="#getting-the-latest-cumulative-price" title="Direct link to heading">#</a></h1><p>If you wish to compute the average price between a historical price cumulative observation and the current cumulative
price, you should use the cumulative price values from the current block. If the cumulative price has not been updated
in the current block, e.g. because there has not been any liquidity event (<code>mint</code>/<code>burn</code>/<code>swap</code>) on the pair in the current
block, you can compute the cumulative price counterfactually.</p><p>We provide a library for use in oracle contracts that has the method
<a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/libraries/UniswapV2OracleLibrary.sol#L16" target="_blank" rel="noopener noreferrer"><code>UniswapV2OracleLibrary#currentCumulativePrices</code></a>
for getting the cumulative price as of the current block.
The current cumulative price returned by this method is computed <em>counterfactually</em>, meaning it requires no call to
the relative gas-expensive <code>#sync</code> method on the pair.
It is correct regardless of whether a swap has already executed in the current block.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="notes-on-overflow"></a>Notes on overflow<a class="hash-link" href="#notes-on-overflow" title="Direct link to heading">#</a></h1><p>The <code>UniswapV2Pair</code> cumulative price variables are designed to eventually overflow,
i.e. <code>price0CumulativeLast</code> and <code>price1CumulativeLast</code> and <code>blockTimestampLast</code> will overflow through 0.</p><p>This should not pose an issue to your oracle design, as the price average computation is concerned with differences
(i.e. subtraction) between two separate observations of a cumulative price variable.
Subtracting between two cumulative price values will result in a number that fits within the range of <code>uint256</code> as long
as the observations are made for periods of max <code>2^32</code> seconds, or ~136 years.</p><p><code>blockTimestampLast</code> is stored only in a <code>uint32</code>. For the same reason as described above, the pair can save a
storage slot, and many SSTORES over the life of the pair, by storing only <code>block.timestamp % uint32(-1)</code>.
This is feasible because the pair is only concerned with the time that elapses between each liquidity event when updating
the cumulative prices, which is always expected to be less than <code>2^32</code> seconds.</p><p>When computing time elapsed within your own oracle, you can simply store the <code>block.timestamp</code> of your observations
as <code>uint256</code>, and avoid dealing with overflow math for computing the time elapsed between observations. This is how the
<a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleSlidingWindowOracle.sol" target="_blank" rel="noopener noreferrer">ExampleSlidingWindowOracle</a>
handles observation timestamps.</p><div href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleSlidingWindowOracle.sol">ExampleSlidingWindowOracle</div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="integrating-the-oracle"></a>Integrating the oracle<a class="hash-link" href="#integrating-the-oracle" title="Direct link to heading">#</a></h2><p>To integrate an oracle into your contracts, you must ensure the oracle&#x27;s observations of the cumulative price variable
are kept up to date.
As long as your oracle is up to date, you can depend on it to produce average prices.
The process of keeping your oracle up to date is called &#x27;maintenance&#x27;.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="oracle-maintenance"></a>Oracle maintenance<a class="hash-link" href="#oracle-maintenance" title="Direct link to heading">#</a></h2><p>In order to measure average prices over a period, the oracle must have a way
of referencing the cumulative price at the start and end of a period.
The recommended way of doing this is by storing these prices in the oracle contract,
and calling the oracle frequently enough to store the latest cumulative price.</p><p>Reliable oracle maintenance is a difficult task,
and can become a point of failure in times of congestion.
Instead, consider building this functionality directly into the
critical calls of your own smart contracts, or incentivize oracle
maintenance calls by other parties.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="no-maintenance-option"></a>No-maintenance option<a class="hash-link" href="#no-maintenance-option" title="Direct link to heading">#</a></h2><p>It is possible to avoid regularly storing this cumulative price at the
start of the period by utilizing storage proofs. However, this approach has limitations,
especially in regard to gas cost and maximum length of the time period over which the average price can be measured.
If you wish to try this approach, you can follow
<a href="https://github.com/Keydonix/uniswap-oracle/" target="_blank" rel="noopener noreferrer">this repository by Keydonix</a>.</p><div href="https://github.com/Keydonix/uniswap-oracle">Keydonix: on-chain trustless and censorship resistant oracle</div><p>Keydonix has developed a general purpose price feed oracle built on Uniswap v2 that supports arbitrary time windows (up to 256 blocks) and doesn&#x27;t require any active maintenance.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/QuickSwap/quickswap-docs/tree/main/versioned_docs/version-V2/guides/smart-contract-integration/04-building-an-oracle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/guides/smart-contract-integration/03-providing-liquidity"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Providing Liquidity</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/guides/smart-contract-integration/05-using-flash-swaps"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Flash Swaps Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#fixed-windows" class="table-of-contents__link">Fixed windows</a></li><li><a href="#moving-averages" class="table-of-contents__link">Moving averages</a></li><li><a href="#computing-average-prices" class="table-of-contents__link">Computing average prices</a></li><li><a href="#integrating-the-oracle" class="table-of-contents__link">Integrating the oracle</a></li><li><a href="#oracle-maintenance" class="table-of-contents__link">Oracle maintenance</a></li><li><a href="#no-maintenance-option" class="table-of-contents__link">No-maintenance option</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Ecosystem</h4><ul class="footer__items"><li class="footer__item"><a href="https://uniswap.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home</a></li><li class="footer__item"><a href="https://quickswap.exchange/" target="_blank" rel="noopener noreferrer" class="footer__link-item">App</a></li><li class="footer__item"><a href="https://info.quickswap.exchange/home" target="_blank" rel="noopener noreferrer" class="footer__link-item">Analytics</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Developers</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Uniswap/uniswap-v3-periphery/blob/main/bug-bounty.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bug Bounty</a></li><li class="footer__item"><a href="https://github.com/QuickSwap/quickswap-core" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub | Protocol</a></li><li class="footer__item"><a href="https://github.com/QuickSwap/QuickSwap-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub | SDK</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://gov.uniswap.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Governance</a></li><li class="footer__item"><a href="https://discord.gg/FCfyBSbCU5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/Uniswap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://uniswap.org/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/assets/js/runtime~main.a011c026.js"></script>
<script src="/assets/js/main.e22ba48b.js"></script>
</body>
</html>